<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Publications - Ocean Dynamics from Space</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans&family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>
    <header>
        <nav>
            <div class="logo">
                <img src="assets/logo.png" alt="Ocean Dynamics Logo">
            </div>
            <div class="hamburger">
                <span></span>
                <span></span>
                <span></span>
            </div>
            <ul class="nav-menu">
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">Team</a></li>
                <li><a href="research.html">Research</a></li>
                <li><a href="publications.html">Publications</a></li>
                <li><a href="data-tools.html">Data & Tools</a></li>
                <li><a href="news.html">News</a></li>
                <li><a href="contact.html">Contact</a></li>
            </ul>
        </nav>
    </header>
    <section class="publications">
        <h1>Publications</h1>
        <p>
            <a href="https://scholar.google.com/citations?hl=en&user=97cDSCsAAAAJ" class="google-scholar" target="_blank" rel="noopener noreferrer">Google Scholar Profile</a> | 
            <a href="https://www.researchgate.net/profile/Jinbo-Wang-2" class="research-gate" target="_blank" rel="noopener noreferrer">ResearchGate Profile</a>
        </p>
        
        <div id="loading">Loading publications...</div>
        <div id="error-message" style="display: none; color: red;"></div>
        
        <div id="publications-content" style="display: none;">
            <h2>Submitted Papers</h2>
            <ul id="submitted-papers-list" class="publication-list"></ul>
            <br>
            <h2>Published Papers</h2>
            <br>
            <div class="sort-controls">
                <div class="filter-control">
                    <label for="filter-by-tag">Filter by Tag:</label>
                    <select id="filter-by-tag" onchange="updatePublications()">
                        <option value="">All Tags</option>
                    </select>
                    
                    <label for="filter-by-year">Filter by Year:</label>
                    <select id="filter-by-year" onchange="updatePublications()">
                        <option value="">All Years</option>
                    </select>
                    
                    <label for="sort-by">Sort by:</label>
                    <select id="sort-by" onchange="updatePublications()">
                        <option value="year-desc">Year (Newest First)</option>
                        <option value="year-asc">Year (Oldest First)</option>
                        <option value="tags">Tags</option>
                    </select>
                </div>
            </div>
            <ul id="publication-list" class="publication-list"></ul>
        </div>
    </section>
    <footer>
        <p>Â© 2025 Ocean Dynamics from Space Lab. All rights reserved.</p>
        <div class="social-links">
            <a href="https://x.com/jinbowang" target="_blank" rel="noopener noreferrer" class="social-icon">
                <img src="https://img.icons8.com/ios-filled/30/ffffff/twitterx.png" alt="X">
            </a>
            <a href="https://www.linkedin.com/in/jinbo-wang-b5138521/" target="_blank" rel="noopener noreferrer" class="social-icon">
                <img src="https://img.icons8.com/ios-filled/30/ffffff/linkedin.png" alt="LinkedIn">
            </a>
        </div>
    </footer>
    <script src="js/script.js"></script>
    <script src="js/bibtex-parser.js"></script>
    <script>
        // Submitted papers data
        const submittedPapers = [
            {
                title: "Observations of Baroclinic Tides in the California Current from the SWOT Satellite Altimeter and In Situ Data",
                year: 2025,
                tags: ["SWOT", "Internal Waves"],
                authors: "Zaron, Waterhouse, Wang, Send, Lucas",
                journal: "JGR Oceans (revision submitted)"
            },
            { 
                title: "Multi-satellite U-Net for high-resolution sea surface temperature reconstruction",
                year: 2025,
                tags: ["machine learning", "sea surface temperature"],
                authors: "Ellin Zhao, Edwin Goh, Alice Yepremyan, Jinbo Wang, and Brian Wilson",
                journal: "Ocean Science (submitted) EGUsphere preprint: https://doi.org/10.5194/egusphere-2025-4847"
            },
            {
                title: "SWOT Geostrophic Velocity Validation against in-situ measurements in the California Current ",
                year: 2025,
                tags: ["Validation", "SWOT", "Ocean Currents"],
                authors: "Babette Tchonang, Jinbo Wang, Amy Frances Waterhouse, Andrew Lucas, Caeli Griffin, Matthew Robert Archer, Luke Kachelein, Matthias Lankhorst, Jeffrey Sevadjian, Lee-Lueng Fu",
                journal: "Earth and Space Science (revision submitted)"
            }
        ];

        let publications = [];
        
        // Load BibTeX file
        async function loadPublications() {
            try {
                console.log('Attempting to load publications.bib...');
                const response = await fetch('publications.bib');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status} - Could not find publications.bib file`);
                }
                
                const bibtexText = await response.text();
                console.log('BibTeX file loaded successfully');
                console.log('First 100 characters:', bibtexText.substring(0, 100));
                
                // Check if BibtexParser is defined
                if (typeof BibtexParser === 'undefined') {
                    throw new Error('BibtexParser is not loaded. Make sure bibtex-parser.js is included.');
                }
                
                const parser = new BibtexParser();
                parser.parse(bibtexText);
                publications = parser.getFormattedPublications();
                
                console.log(`Parsed ${publications.length} publications`);
                
                if (publications.length === 0) {
                    throw new Error('No publications were parsed from the BibTeX file');
                }
                
                // Hide loading, show content
                document.getElementById('loading').style.display = 'none';
                document.getElementById('publications-content').style.display = 'block';
                
                // Populate dropdowns and display publications
                populateTagDropdown();
                populateYearDropdown();
                displaySubmittedPapers(submittedPapers);
                updatePublications();
            } catch (error) {
                console.error('Error loading publications:', error);
                document.getElementById('loading').style.display = 'none';
                const errorDiv = document.getElementById('error-message');
                errorDiv.style.display = 'block';
                errorDiv.innerHTML = `
                    <strong>Error loading publications:</strong> ${error.message}<br>
                    <small>Please check the browser console for more details.</small><br>
                    <small>Make sure publications.bib is in the same folder as publications.html</small>
                `;
            }
        }
        
        // Function to populate tag dropdown dynamically
        function populateTagDropdown() {
            const tagSelect = document.getElementById('filter-by-tag');
            if (tagSelect) {
                // Get unique tags from publications
                const allTags = new Set();
                publications.forEach(pub => {
                    if (pub.tags) {
                        pub.tags.forEach(tag => allTags.add(tag));
                    }
                });
                
                // Sort tags alphabetically
                const sortedTags = Array.from(allTags).sort();
                
                // Add tag options
                sortedTags.forEach(tag => {
                    const option = document.createElement('option');
                    option.value = tag;
                    option.textContent = tag;
                    tagSelect.appendChild(option);
                });
            }
        }
        
        // Function to populate year dropdown
        function populateYearDropdown() {
            const yearSelect = document.getElementById('filter-by-year');
            if (yearSelect) {
                // Get unique years from publications and sort in descending order
                const years = [...new Set(publications.map(pub => pub.year))].sort((a, b) => b - a);
                
                // Add year options
                years.forEach(year => {
                    const option = document.createElement('option');
                    option.value = year;
                    option.textContent = year;
                    yearSelect.appendChild(option);
                });
            }
        }
        
        function displaySubmittedPapers(pubList) {
            const list = document.getElementById('submitted-papers-list');
            if (list) {
                list.innerHTML = '';
                pubList.forEach(pub => {
                    const li = document.createElement('li');
                    li.innerHTML = `${pub.authors} - <strong>${pub.title}</strong> (${pub.year}), ${pub.journal}`;
                    list.appendChild(li);
                });
            }
        }
        
        function displayPublications(pubList) {
            const list = document.getElementById('publication-list');
            if (list) {
                list.innerHTML = '';
                if (pubList.length === 0) {
                    list.innerHTML = '<li>No publications match the selected filters.</li>';
                    return;
                }
                pubList.forEach(pub => {
                    const li = document.createElement('li');
                    li.innerHTML = `${pub.authors} - <strong>${pub.title}</strong> (${pub.year}), ${pub.journal}`;
                    list.appendChild(li);
                });
            }
        }
        
        function filterPublications(tag, year) {
            let filtered = [...publications];
            
            // Filter by tag
            if (tag && tag !== '') {
                filtered = filtered.filter(pub => pub.tags && pub.tags.includes(tag));
            }
            
            // Filter by year
            if (year && year !== '') {
                filtered = filtered.filter(pub => pub.year === parseInt(year));
            }
            
            return filtered;
        }
        
        function updatePublications() {
            const sortBy = document.getElementById('sort-by')?.value;
            const filterTag = document.getElementById('filter-by-tag')?.value;
            const filterYear = document.getElementById('filter-by-year')?.value;
            
            // Filter publications
            let filteredPubs = filterPublications(filterTag, filterYear);
            
            // Sort publications
            if (sortBy === 'year-desc') {
                filteredPubs.sort((a, b) => b.year - a.year || a.title.localeCompare(b.title));
            } else if (sortBy === 'year-asc') {
                filteredPubs.sort((a, b) => a.year - b.year || a.title.localeCompare(b.title));
            } else if (sortBy === 'tags') {
                filteredPubs.sort((a, b) => {
                    const tagsA = (a.tags || []).join(', ');
                    const tagsB = (b.tags || []).join(', ');
                    return tagsA.localeCompare(tagsB) || b.year - a.year;
                });
            }
            
            displayPublications(filteredPubs);
        }
        
        // Load publications when page loads
        document.addEventListener('DOMContentLoaded', loadPublications);
    </script>
</body>
</html>